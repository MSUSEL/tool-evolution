import os
from dotenv import load_dotenv

###
# Initialize Variables
###

# Hardcoded for now. Data is from https://pypi.org/project/cve-bin-tool/#history
#   Note: Ignoring Pre-releases: "2.0a0", "3.1rc2", "3.1rc3"
pip_releases = ["1.0", "1.1", "2.0", "2.1", \
                            "2.1.post1", "2.2", "2.2.1", "3.0",  "3.1", "3.1.1"]
CANNOT_READ_OUTPUT_ERROR_CODE = -101
threads = []

# Load File names from binary
load_dotenv()
path_to_binary = os.getenv('PATH_TO_BINARY')
binary_files = os.listdir(path_to_binary)

# Initialize results dictionary
results = {}
for file_name in binary_files:
    results[file_name] = {}


###
# Define Helper Functions
###

def append_to_results(file_name, release, vulnerabilities):
    results[file_name][release] = vulnerabilities

def report_thread(t):
    threads.append(t)

def clear_threads():
    threads.clear()